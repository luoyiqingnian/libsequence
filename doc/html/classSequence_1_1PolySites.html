<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libsequence: Sequence::PolySites Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libsequence
   &#160;<span id="projectnumber">1.9.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classSequence_1_1PolySites.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classSequence_1_1PolySites-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Sequence::PolySites Class Reference<div class="ingroups"><a class="el" href="group__popgen.html">Molecular Population Genetics</a> &raquo; <a class="el" href="group__polytables.html">Classes Related to Polymorphism tables</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Polymorphism tables for sequence data.  
 <a href="classSequence_1_1PolySites.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="PolySites_8hpp_source.html">Sequence/PolySites.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Sequence::PolySites:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classSequence_1_1PolySites.png" usemap="#Sequence::PolySites_map" alt=""/>
  <map id="Sequence::PolySites_map" name="Sequence::PolySites_map">
<area href="classSequence_1_1PolyTable.html" title="The base class for polymorphism tables. " alt="Sequence::PolyTable" shape="rect" coords="0,0,130,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa2a6be251bc85584b42ac6c3f4524949"><td class="memTemplParams" colspan="2"><a id="aa2a6be251bc85584b42ac6c3f4524949"></a>
template&lt;typename __DataType &gt; </td></tr>
<tr class="memitem:aa2a6be251bc85584b42ac6c3f4524949"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><b>PolySites</b> (const std::vector&lt; __DataType &gt; &amp;alignment, bool strictInfSites=0, bool ignoregaps=1, bool skipMissing=false, bool skipAdjSNP=false, unsigned freqfilter=0)</td></tr>
<tr class="separator:aa2a6be251bc85584b42ac6c3f4524949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3fda96619a3b9618a45c03a137edbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSequence_1_1PolySites.html#afc3fda96619a3b9618a45c03a137edbd">PolySites</a> (std::vector&lt; double &gt; List, std::vector&lt; std::string &gt; stringList)</td></tr>
<tr class="separator:afc3fda96619a3b9618a45c03a137edbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14f4d12c39b24abeb6124137c7f85d6"><td class="memItemLeft" align="right" valign="top"><a id="af14f4d12c39b24abeb6124137c7f85d6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PolySites</b> (PolyTable::const_site_iterator beg, PolyTable::const_site_iterator end)</td></tr>
<tr class="separator:af14f4d12c39b24abeb6124137c7f85d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187f5414002d6aa66588530cb2411944"><td class="memItemLeft" align="right" valign="top"><a id="a187f5414002d6aa66588530cb2411944"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PolySites</b> (<a class="el" href="classSequence_1_1PolySites.html">PolySites</a> &amp;&amp;)</td></tr>
<tr class="separator:a187f5414002d6aa66588530cb2411944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e054216a832d6ad23861e109e0b2449"><td class="memItemLeft" align="right" valign="top"><a id="a5e054216a832d6ad23861e109e0b2449"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PolySites</b> (const <a class="el" href="classSequence_1_1PolySites.html">PolySites</a> &amp;)</td></tr>
<tr class="separator:a5e054216a832d6ad23861e109e0b2449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c0ed26d2d175c2c15e3170a7346d09"><td class="memItemLeft" align="right" valign="top"><a id="a82c0ed26d2d175c2c15e3170a7346d09"></a>
<a class="el" href="classSequence_1_1PolySites.html">PolySites</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classSequence_1_1PolySites.html">PolySites</a> &amp;&amp;)</td></tr>
<tr class="separator:a82c0ed26d2d175c2c15e3170a7346d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b97b5e07daf9e2b29b5efc68ad1e66f"><td class="memItemLeft" align="right" valign="top"><a id="a5b97b5e07daf9e2b29b5efc68ad1e66f"></a>
<a class="el" href="classSequence_1_1PolySites.html">PolySites</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classSequence_1_1PolySites.html">PolySites</a> &amp;)</td></tr>
<tr class="separator:a5b97b5e07daf9e2b29b5efc68ad1e66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f1477e1e5af9b8c5de61f07bf544c4"><td class="memItemLeft" align="right" valign="top"><a id="aa9f1477e1e5af9b8c5de61f07bf544c4"></a>
std::istream &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>read</b> (std::istream &amp;s)</td></tr>
<tr class="separator:aa9f1477e1e5af9b8c5de61f07bf544c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8d2b69228a05251086967e948844ef"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSequence_1_1PolySites.html#a9a8d2b69228a05251086967e948844ef">print</a> (std::ostream &amp;stream) const</td></tr>
<tr class="memdesc:a9a8d2b69228a05251086967e948844ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">output a tab-delimited array of positions and character states  <a href="#a9a8d2b69228a05251086967e948844ef">More...</a><br /></td></tr>
<tr class="separator:a9a8d2b69228a05251086967e948844ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Polymorphism tables for sequence data. </p>
<p>This is one of the more useful classes in namespace <a class="el" href="namespaceSequence.html" title="The namespace in which this library resides. ">Sequence</a>. Its purpose is to take a bunch of data (a vector&lt;Fasta&gt; in fact), and turn it into a list of variable positions. It doesn't matter whether or not you have an outgroup in you vector (except that if you want to use it for later analysis, it had better be present).<br />
<br />
The default behavior of this class is just to play with the std::strings themselves. So what you end up with is a vector of variable sites, stored in PolyData::positions, and a vector ofstd::strings containing the variable sites, stored in PolyData::data. Note that if you include an outgroup in your vector&lt;Fasta&gt;, and it contains a different character than the ingroup at some site, then the site is considered variable.<br />
<br />
You can also try and turn the data into a "binary" (i.e. 0 and 1) format, by a call to Sequence::PolySites::Binary. <br />
EXAMPLE:<br />
Here is a common use of a <a class="el" href="classSequence_1_1PolySites.html" title="Polymorphism tables for sequence data. ">PolySites</a> class. You have a file, "gene.fasta", containing some number of sequences that represent polymorphism data. The file is assumed to be aligned, but we'll check for that, just in case you forgot to run <a class="el" href="classSequence_1_1ClustalW.html" title="ClustalW streams. ">ClustalW</a> or something.<br />
<br />
</p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Fasta_8hpp.html">Sequence/Fasta.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Alignment_8hpp.html">Sequence/Alignment.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;Sequence/SeqExceptions.hpp&gt;</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *infile = <span class="stringliteral">&quot;gene.fasta&quot;</span>;</div><div class="line">vector&lt;Fasta&gt; data;</div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">Sequence::Alignment::GetData (data,infile);</div><div class="line">assert( Sequence::Alignment::IsAlignment (data) );</div><div class="line"><span class="keywordflow">if</span> ( Sequence::Alignment::Gapped (data) ) </div><div class="line"><a class="code" href="namespaceSequence_1_1Alignment.html#a5c97799d32bb988ebcb44500c4d91351">Sequence::Alignment::RemoveTerminalGaps</a> (data);</div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span> (SeqException &amp;e)</div><div class="line">{</div><div class="line">cerr &lt;&lt; <span class="stringliteral">&quot;uh-oh! processing file gene.fasta resulted in throwing an exception&quot;</span>&lt;&lt;endl;</div><div class="line">e.print(cerr);</div><div class="line">cerr &lt;&lt; endl;</div><div class="line">exit(1);</div><div class="line">}</div><div class="line">PolySites *polytable = <span class="keyword">new</span> PolySites(data);</div><div class="line">}</div></div><!-- fragment --><p> <br />
Removing the terminal gaps guarantees that polymorphic site positions are labelled starting from the first ungapped position. Of course, a lot of the extra syntax in the example can be eliminated by giving the following 2 using declarations:<br />
using namespace <a class="el" href="namespaceSequence.html" title="The namespace in which this library resides. ">Sequence</a>;<br />
using namespace <a class="el" href="namespaceSequence_1_1Alignment.html" title="Routines fundamental to aligned data. ">Sequence::Alignment</a>;<br />
<br />
For a second example, assume the data are in the file "gene.aln", the results of a <a class="el" href="classSequence_1_1ClustalW.html" title="ClustalW streams. ">ClustalW</a> alignment.<br />
<br />
</p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Clustalw_8hpp.html">Sequence/Clustalw.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Fasta_8hpp.html">Sequence/Fasta.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;Sequence/SeqExceptions.hpp&gt;</span></div><div class="line">    </div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div><div class="line">istream in;</div><div class="line">in.open(<span class="stringliteral">&quot;gene.aln&quot;</span>);</div><div class="line">ClustalW&lt;Fasta&gt; aligned_data;</div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">in &gt;&gt; aligned_data;</div><div class="line">assert(aligned_data.IsAlignment());</div><div class="line"><span class="keywordflow">if</span>(aligned_data.Gapped())</div><div class="line">aligned_data.RemoveTerminalGaps();</div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span> (SeqException &amp;e)</div><div class="line">{</div><div class="line">cerr &lt;&lt; <span class="stringliteral">&quot;uh-oh! processing file gene.aln resulted in throwing an exception&quot;</span>&lt;&lt;endl;</div><div class="line">e.print(cerr);</div><div class="line">cerr &lt;&lt; endl;</div><div class="line">exit(1);</div><div class="line">}</div><div class="line">PolySites *polytable = <span class="keyword">new</span> PolySites(aligned_data.GetData());</div><div class="line">}</div></div><!-- fragment --> <dl><dt><b>Examples: </b></dt><dd><a class="el" href="PolyTableIterators_8cc-example.html#_a0">PolyTableIterators.cc</a>, <a class="el" href="slidingWindow_8cc-example.html#_a0">slidingWindow.cc</a>, and <a class="el" href="slidingWindow2_8cc-example.html#_a0">slidingWindow2.cc</a>.</dd>
</dl>
<p class="definition">Definition at line <a class="el" href="PolySites_8hpp_source.html#l00033">33</a> of file <a class="el" href="PolySites_8hpp_source.html">PolySites.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afc3fda96619a3b9618a45c03a137edbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc3fda96619a3b9618a45c03a137edbd">&#9670;&nbsp;</a></span>PolySites()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sequence::PolySites::PolySites </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>List</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>stringList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Use this constructor if you already have a list of positions and characters </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">List</td><td>a list of doubles representing positions of polymorphic positions </td></tr>
    <tr><td class="paramname">stringList</td><td>a vector of strings representing the polymorphic characters </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PolySites_8cc_source.html#l00134">134</a> of file <a class="el" href="PolySites_8cc_source.html">PolySites.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9a8d2b69228a05251086967e948844ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a8d2b69228a05251086967e948844ef">&#9670;&nbsp;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; Sequence::PolySites::print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>output a tab-delimited array of positions and character states </p>
<p>Allows objects of type <a class="el" href="classSequence_1_1PolySites.html" title="Polymorphism tables for sequence data. ">Sequence::PolySites</a> to be written to output streams. The output is a simple, tab-delimited table of variable site positions and characters </p><dl class="section note"><dt>Note</dt><dd>segsite positions are output with the count starting from 1, not zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="PolySites_8cc_source.html#l00191">191</a> of file <a class="el" href="PolySites_8cc_source.html">PolySites.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="PolySites_8hpp_source.html">PolySites.hpp</a></li>
<li><a class="el" href="PolySites_8cc_source.html">PolySites.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceSequence.html">Sequence</a></li><li class="navelem"><a class="el" href="classSequence_1_1PolySites.html">PolySites</a></li>
    <li class="footer">Generated on Thu Jul 12 2018 15:34:19 for libsequence by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

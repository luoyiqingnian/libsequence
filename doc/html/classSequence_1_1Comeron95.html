<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libsequence: Sequence::Comeron95 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libsequence
   &#160;<span id="projectnumber">1.9.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classSequence_1_1Comeron95.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classSequence_1_1Comeron95-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Sequence::Comeron95 Class Reference<div class="ingroups"><a class="el" href="group__divergence.html">Divergence Statistics</a> &raquo; <a class="el" href="group__kaks.html">Classes related to the calculation of Ka and Ks</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Ka and Ks by Comeron's (1995) method.  
 <a href="classSequence_1_1Comeron95.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Comeron95_8hpp_source.html">Sequence/Comeron95.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaff1ba6d51cc82e012861b104b48d239"><td class="memItemLeft" align="right" valign="top"><a id="aaff1ba6d51cc82e012861b104b48d239"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Comeron95</b> (<a class="el" href="namespaceSequence.html#a5e0228ffad6c8cf2441604124c8b9961">GeneticCodes</a> code=GeneticCodes::UNIVERSAL)</td></tr>
<tr class="separator:aaff1ba6d51cc82e012861b104b48d239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab203d470e3cc76d35bd0e169a177ee76"><td class="memItemLeft" align="right" valign="top"><a id="ab203d470e3cc76d35bd0e169a177ee76"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Comeron95</b> (const <a class="el" href="classSequence_1_1Comeron95.html">Comeron95</a> &amp;)=delete</td></tr>
<tr class="separator:ab203d470e3cc76d35bd0e169a177ee76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cdb6a41e309499f8417ed1659df1bdd"><td class="memItemLeft" align="right" valign="top"><a id="a0cdb6a41e309499f8417ed1659df1bdd"></a>
<a class="el" href="classSequence_1_1Comeron95.html">Comeron95</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classSequence_1_1Comeron95.html">Comeron95</a> &amp;)=delete</td></tr>
<tr class="separator:a0cdb6a41e309499f8417ed1659df1bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a887d3bedea66e3b1135411aa55eccd33"><td class="memItemLeft" align="right" valign="top">Com95_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSequence_1_1Comeron95.html#a887d3bedea66e3b1135411aa55eccd33">operator()</a> (const <a class="el" href="classSequence_1_1Seq.html">Sequence::Seq</a> &amp;seqa, const <a class="el" href="classSequence_1_1Seq.html">Sequence::Seq</a> &amp;seqb, int maxdiffs=3)</td></tr>
<tr class="separator:a887d3bedea66e3b1135411aa55eccd33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce23bbc343366fb9ac559f83372dab8"><td class="memItemLeft" align="right" valign="top"><a id="a2ce23bbc343366fb9ac559f83372dab8"></a>
Com95_t&#160;</td><td class="memItemRight" valign="bottom"><b>operator()</b> (const <a class="el" href="classSequence_1_1Seq.html">Sequence::Seq</a> &amp;seqa, const <a class="el" href="classSequence_1_1Seq.html">Sequence::Seq</a> &amp;seqb, const <a class="el" href="structSequence_1_1WeightingScheme2.html">WeightingScheme2</a> *weights2, const <a class="el" href="structSequence_1_1WeightingScheme3.html">WeightingScheme3</a> *weights3, int maxdiffs=3)</td></tr>
<tr class="separator:a2ce23bbc343366fb9ac559f83372dab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Ka and Ks by Comeron's (1995) method. </p>
<p>A definition of an object to implement Comeron's (1995) method to calculate Ka and Ks The reference is: Comeron, J. (1995) J. Molecular Evolution, 41: 1152-1159. The object has a simple purpose, but it requires a lot of code to do it. The calculation depends upon the following classes:<br />
<a class="el" href="classSequence_1_1RedundancyCom95.html" title="Calculate redundancy of a genetic code using Comeron&#39;s counting scheme. ">Sequence::RedundancyCom95</a><br />
<a class="el" href="classSequence_1_1Sites.html" title="Calculate length statistics for divergence calculations. ">Sequence::Sites</a><br />
<a class="el" href="classSequence_1_1SingleSub.html" title="Deal with codons differing at 1 position. ">Sequence::SingleSub</a><br />
<a class="el" href="classSequence_1_1TwoSubs.html" title="Deal with codons differing at 2 positions. ">Sequence::TwoSubs</a><br />
<a class="el" href="classSequence_1_1ThreeSubs.html" title="Deal with codons differing at all 3 positions. ">Sequence::ThreeSubs</a><br />
<br />
The calculation can be done on any objects of type <a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a> *, or anything derived from there.<br />
<br />
You should be warned that this class depends heavily on namespace <a class="el" href="namespaceSequence.html" title="The namespace in which this library resides. ">Sequence</a> (the libsequence library), and may throw any and all exceptions defined in that library, so you should see the documentation for that library. </p><dl class="section note"><dt>Note</dt><dd>This class allows weighting of pathways where codons differ at more than 1 site to be done using any arbitrary weighting scheme. To do so, however, requires deriving classes from <a class="el" href="structSequence_1_1WeightingScheme2.html" title="abstract interface to weighting schemes when codons differ at 2 positions ">Sequence::WeightingScheme2</a> and <a class="el" href="structSequence_1_1WeightingScheme2.html" title="abstract interface to weighting schemes when codons differ at 2 positions ">Sequence::WeightingScheme2</a>. See the code for <a class="el" href="structSequence_1_1GranthamWeights2.html" title="Weights paths by Grantham&#39;s distances for codons differing at 2 sites. ">Sequence::GranthamWeights2</a> and <a class="el" href="structSequence_1_1GranthamWeights3.html" title="Weights paths by Grantham&#39;s distances for codons differing at 3 sites. ">Sequence::GranthamWeights3</a> for an example of how to do this (in the files <a class="el" href="GranthamWeights_8cc_source.html">GranthamWeights.cc</a> and <a class="el" href="GranthamWeights_8hpp.html" title="declaration of classes to weight codons by Grantham distance (i.e. for Sequence::Comeron95). Declares Sequence::GranthamWeights2 and Sequence::GranthamWeights3 ">GranthamWeights.hpp</a>). You will also need to study <a class="el" href="TwoSubs_8cc_source.html">TwoSubs.cc</a>/.hpp and <a class="el" href="ThreeSubs_8cc_source.html">ThreeSubs.cc</a>/.hpp to understand how branches and intermediate codons are labelled (because you need to do it correctly in your implementation of weighting schemes)<br />
</dd>
<dd>
This class is best used in the form <code>auto_ptr&lt;Comeron95&gt;</code>, as illustrated in the example below. The reason to use <code>auto_ptr</code> is to prevent resource leaks in case an exception is thrown. This class has strict requirements about the data it is passed, resulting in several places where exceptions can be thrown. Most of these situations are caught in the constructor, which will prevent most leaks. However, anything is possible, so use <code>auto_ptr</code> <br />
Example: a simple program to calculate Ka and Ks:<br />
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;memory&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Fasta_8hpp.html">Sequence/Fasta.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Alignment_8hpp.html">Sequence/Alignment.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;Sequence/SeqExceptions.hpp&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Comeron95_8hpp.html">Sequence/Comeron95.hpp</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//using namespace std;</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceSequence.html">Sequence</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main</div><div class="line">{</div><div class="line">  <span class="keywordtype">char</span> *filename = argv[1];</div><div class="line">  vector&lt;Fasta &gt; data;</div><div class="line">  </div><div class="line">  <span class="comment">//read data in from a file in Fasta Format</span></div><div class="line">  <span class="comment">//program will exit if file is badly format</span></div><div class="line">  <span class="comment">//the reason for the exit will be an uncaught</span></div><div class="line">  <span class="comment">//exception Sequence::badFormat</span></div><div class="line">  Alignment::GetData(data,filename);</div><div class="line"></div><div class="line">  <span class="comment">//abort() unless all sequence objects are the same length</span></div><div class="line">  assert(Alignment::IsAlignment(data));</div><div class="line"></div><div class="line">  <span class="comment">//iterate over the data</span></div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0 ; i &lt; data.size()-1 ; ++i)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j = i+1 ; j &lt; data.size() ; ++j)</div><div class="line">    {</div><div class="line">    <span class="comment">//calculate and output results</span></div><div class="line">      <span class="keywordflow">try</span></div><div class="line">      {</div><div class="line">      auto_ptr&lt;Comeron95&gt; C(<span class="keyword">new</span> <a class="code" href="classSequence_1_1Comeron95.html">Comeron95</a>(&amp;data[i],&amp;data[j]));</div><div class="line">      cout &lt;&lt; data[i].GetName() &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; data[j].GetName() &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div><div class="line">      cout &lt;&lt; C-&gt;ka() &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; C-&gt;ks() &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; C-&gt;ratio() &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">if</span> (std::isfinite(C-&gt;ratio()) &amp;&amp; C-&gt;ratio() &gt; 1.0)</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;congratulations, you win!&quot;</span> &lt;&lt; endl;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">catch</span> (SeqException &amp;e)</div><div class="line">      {</div><div class="line">        cout &lt;&lt; e &lt;&lt; endl;</div><div class="line">      }</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Comeron95_8hpp_source.html#l00125">125</a> of file <a class="el" href="Comeron95_8hpp_source.html">Comeron95.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a887d3bedea66e3b1135411aa55eccd33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a887d3bedea66e3b1135411aa55eccd33">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Com95_t Sequence::Comeron95::operator() </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSequence_1_1Seq.html">Sequence::Seq</a> &amp;&#160;</td>
          <td class="paramname"><em>seqa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSequence_1_1Seq.html">Sequence::Seq</a> &amp;&#160;</td>
          <td class="paramname"><em>seqb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max</em> = <code>3</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize and calculate synonymous and nonsynonymous distances between two sequence objects </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seqa</td><td>an object of type or derived from type <a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a> </td></tr>
    <tr><td class="paramname">seqb</td><td>an object of type or derived from type <a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a> </td></tr>
    <tr><td class="paramname">max</td><td>maximum number of substitutions per codon to allow in the analysis </td></tr>
    <tr><td class="paramname">code</td><td>genetic code, see <a class="el" href="namespaceSequence.html#a5e0228ffad6c8cf2441604124c8b9961">Sequence::GeneticCodes</a> </td></tr>
    <tr><td class="paramname">_weights2</td><td>a weighting scheme for codons differing at 2 positions. If <code>NULL</code>, <a class="el" href="structSequence_1_1GranthamWeights2.html" title="Weights paths by Grantham&#39;s distances for codons differing at 2 sites. ">Sequence::GranthamWeights2</a> is used </td></tr>
    <tr><td class="paramname">_weights3</td><td>a weighting scheme for codons differing at 3 positions. If <code>NULL</code>, <a class="el" href="structSequence_1_1GranthamWeights3.html" title="Weights paths by Grantham&#39;s distances for codons differing at 3 sites. ">Sequence::GranthamWeights3</a> is used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Note that the pointers to weighting schemes are dumb pointers. This allows me to check for NULL and then assign a default. If you use your own classes, make sure they clean up after themselves if they throw exceptions!!! </dd></dl>

<p class="definition">Definition at line <a class="el" href="Comeron95_8cc_source.html#l00157">157</a> of file <a class="el" href="Comeron95_8cc_source.html">Comeron95.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Comeron95_8hpp_source.html">Comeron95.hpp</a></li>
<li><a class="el" href="Comeron95_8cc_source.html">Comeron95.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceSequence.html">Sequence</a></li><li class="navelem"><a class="el" href="classSequence_1_1Comeron95.html">Comeron95</a></li>
    <li class="footer">Generated on Mon Oct 16 2017 17:01:27 for libsequence by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
